# TWSE Strategy Backtesting System

這是一個專為台灣證券交易所 (TWSE) 股票設計的自動化回測系統。系統包含資料抓取、策略掃描、回測績效分析以及圖形化介面。

## 核心功能

- **資料管理**：自動從 TWSE 官網抓取日線資料，並儲存於 SQLite 資料庫中。支援自動解析交易日行事曆（避開週休二日與國定假日）。
- **策略掃描**：
  - 支援多種技術指標策略（如 5MA 穿過 10MA、黃金交叉等）。
  - 支援「最新訊號」掃描，快速找出當前符合條件的股票。
  - 支援週線策略掃描，提供中長期趨勢參考。
- **回測分析**：
  - 自動計算持有 N 天後的報酬率（5天、10天、20天等）。
  - 提供績效摘要（勝率、平均報酬率、總和報酬率）。
  - 支援結果匯出至 CSV。
- **視覺化介面**：使用 Tkinter 打造直觀的操作介面，整合資料下載與策略掃描功能。
- **圖表分析**：整合 K 線圖與技術指標視覺化（選配）。

## 專案結構

- `reader.py`: 資料抓取核心，負責與 TWSE API 通訊、資料清理、SQLite 存取。
- `strategy_backtester.py`: 策略邏輯核心，包含各類技術指標計算與回測演算法。
- `strategy_gui.py`: 主程式入口，提供分層式的圖形化介面。
- `plotter.py`: 負責繪製股票 K 線圖與指標。
- `data/`: 存放 SQLite 資料庫 (`twse_data.db`) 與 CSV 快取。

## 安裝與執行

1. **環境需求**：Python 3.8+
2. **安裝依賴**：
   ```bash
   pip install pandas requests beautifulsoup4
   ```
3. **執行主程式**：
   - 直接執行：`python strategy_gui.py`
   - 使用批次檔：點擊 `run_gui.bat`

## 使用說明

1. **資料更新**：進入「資料管理」頁面，選擇要更新的天數並點擊「開始下載」。
2. **選擇策略**：在「策略回測」或「週線策略」頁面中勾選想要執行的策略。
3. **執行掃描**：設定日期範圍或勾選「只看最新訊號」，點擊「執行策略掃描」。
4. **分析結果**：掃描完成後，下方列表會顯示符合條件的股票代號與預期報酬。

## 開發者資訊

- **Author**: Jack
- **Repository**: [Backtesting](https://github.com/Jackat0324/Backtesting)
